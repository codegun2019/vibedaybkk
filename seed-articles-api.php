<?php
/**
 * API สำหรับเพิ่มบทความตัวอย่าง
 */

require_once 'includes/config.php';
require_once 'includes/functions.php';

header('Content-Type: application/json');

// อ่านข้อมูล JSON
$input = file_get_contents('php://input');
$data = json_decode($input, true);

if (!$data || !isset($data['action'])) {
    echo json_encode(['success' => false, 'error' => 'Invalid request']);
    exit;
}

// ฟังก์ชันสร้าง slug
function createSlug($text) {
    $thai_to_eng = array(
        'ก' => 'k', 'ข' => 'kh', 'ฃ' => 'kh', 'ค' => 'kh', 'ฅ' => 'kh', 'ฆ' => 'kh',
        'ง' => 'ng', 'จ' => 'ch', 'ฉ' => 'ch', 'ช' => 'ch', 'ซ' => 's', 'ฌ' => 'ch',
        'ญ' => 'y', 'ฎ' => 'd', 'ฏ' => 't', 'ฐ' => 'th', 'ฑ' => 'th', 'ฒ' => 'th',
        'ณ' => 'n', 'ด' => 'd', 'ต' => 't', 'ถ' => 'th', 'ท' => 'th', 'ธ' => 'th',
        'น' => 'n', 'บ' => 'b', 'ป' => 'p', 'ผ' => 'ph', 'ฝ' => 'f', 'พ' => 'ph',
        'ฟ' => 'f', 'ภ' => 'ph', 'ม' => 'm', 'ย' => 'y', 'ร' => 'r', 'ฤ' => 'rue',
        'ล' => 'l', 'ฦ' => 'lue', 'ว' => 'w', 'ศ' => 's', 'ษ' => 's', 'ส' => 's',
        'ห' => 'h', 'ฬ' => 'l', 'อ' => 'o', 'ฮ' => 'h',
        'ะ' => 'a', 'ั' => 'a', 'า' => 'a', 'ำ' => 'am', 'ิ' => 'i', 'ี' => 'i',
        'ึ' => 'ue', 'ื' => 'ue', 'ุ' => 'u', 'ู' => 'u',
        'เ' => 'e', 'แ' => 'ae', 'โ' => 'o', 'ใ' => 'ai', 'ไ' => 'ai',
        '็' => '', '่' => '', '้' => '', '์' => '', 'ํ' => '', 'ๆ' => '',
        '๐' => '0', '๑' => '1', '๒' => '2', '๓' => '3', '๔' => '4',
        '๕' => '5', '๖' => '6', '๗' => '7', '๘' => '8', '๙' => '9',
        ' ' => '-', '_' => '-'
    );
    
    $text = strtr($text, $thai_to_eng);
    $text = preg_replace('/[^a-zA-Z0-9\-]/', '', $text);
    $text = preg_replace('/-+/', '-', $text);
    $text = trim($text, '-');
    $text = strtolower($text);
    
    return $text;
}

if ($data['action'] === 'delete_all') {
    $result = $conn->query("SELECT COUNT(*) as count FROM articles");
    $row = $result->fetch_assoc();
    $deleted_count = $row['count'];
    
    $conn->query("DELETE FROM articles");
    $conn->query("ALTER TABLE articles AUTO_INCREMENT = 1");
    
    echo json_encode([
        'success' => true,
        'deleted_count' => $deleted_count
    ]);
    exit;
}

if ($data['action'] === 'add') {
    $index = $data['index'];
    
    // ตรวจสอบว่าตารางมีคอลัมน์อะไรบ้าง
    $columns_result = $conn->query("DESCRIBE articles");
    $existing_columns = [];
    while ($col = $columns_result->fetch_assoc()) {
        $existing_columns[] = $col['Field'];
    }
    
    // ดึงหมวดหมู่
    $categories = db_get_rows($conn, "SELECT id, name FROM article_categories WHERE status = 'active' ORDER BY id ASC");
    
    if (empty($categories)) {
        echo json_encode(['success' => false, 'error' => 'ไม่พบหมวดหมู่บทความ กรุณาเพิ่มหมวดหมู่ก่อน']);
        exit;
    }
    
    // ข้อมูลบทความตัวอย่าง
    $articles_data = [
        [
            'title' => 'เทรนด์แฟชั่นฤดูร้อนปี 2025 ที่คุณไม่ควรพลาด',
            'category_id' => 2, // แฟชั่น
            'excerpt' => 'มาดูกันว่าเทรนด์แฟชั่นฤดูร้อนปีนี้มีอะไรบ้าง และจะทำให้คุณดูโดดเด่นได้อย่างไร',
            'content' => 'เทรนด์แฟชั่นฤดูร้อนปี 2025 มาพร้อมกับสีสันสดใสและสไตล์ที่ผ่อนคลาย เน้นความสบายแต่ยังคงความเก๋ไก๋ ไม่ว่าจะเป็นชุดเดรสลายดอกไม้ที่กำลังกลับมาเป็นที่นิยม หรือกางเกงขาสั้นทรงสบายที่ใส่แล้วดูดี มีสไตล์ในตัวเอง\n\nนอกจากนี้ยังมีอุปกรณ์เสริมอย่างหมวกทรงกว้าง แว่นตากันแดดรูปทรงโมเดิร์น และรองเท้าแซนเดิลที่สวมใส่สบาย ซึ่งจะช่วยเติมเต็มลุคให้สมบูรณ์แบบ สีที่ฮิตในฤดูนี้ได้แก่ สีพาสเทล สีส้มโอรส สีเขียวมิ้นต์ และสีครีมที่ให้ความรู้สึกอบอุ่นและน่ารัก\n\nการเลือกเสื้อผ้าในฤดูร้อนควรเน้นเนื้อผ้าที่ระบายอากาศได้ดี เช่น ผ้าลินิน ผ้าฝ้าย หรือผ้าซิลค์ ซึ่งจะช่วยให้คุณรู้สึกสบายตัวแม้ในอากาศที่ร้อนแรง พร้อมทั้งยังดูมีสไตล์และทันสมัยอยู่เสมอ',
            'tags' => 'แฟชั่น,เทรนด์,ฤดูร้อน,สไตล์'
        ],
        [
            'title' => '5 เคล็ดลับการถ่ายภาพโมเดลให้สวยโดนใจ',
            'category_id' => 5, // การถ่ายภาพ
            'excerpt' => 'เทคนิคการถ่ายภาพโมเดลที่จะทำให้ภาพของคุณดูเป็นมืออาชีพและน่าสนใจมากขึ้น',
            'content' => 'การถ่ายภาพโมเดลเป็นศิลปะที่ต้องอาศัยทั้งเทคนิคและความเข้าใจในการใช้แสงและมุมกล้อง วันนี้เรามี 5 เคล็ดลับที่จะช่วยให้คุณถ่ายภาพโมเดลได้สวยและเป็นมืออาชีพ\n\n1. เลือกแสงที่เหมาะสม - แสงธรรมชาติในช่วงเช้าหรือเย็นจะให้ภาพที่นุ่มนวลและสวยงาม หลีกเลี่ยงแสงจ้าในเที่ยงวัน\n\n2. หาทำแลงที่เหมาะสม - สถานที่ถ่ายภาพควรมีพื้นหลังที่ไม่รกรุงรัง เพื่อให้โฟกัสไปที่โมเดล\n\n3. สื่อสารกับโมเดล - การสื่อสารที่ดีจะช่วยให้โมเดลรู้สึกสบายใจและแสดงออกได้ดีขึ้น\n\n4. ใช้ Composition ที่น่าสนใจ - ลองใช้ Rule of Thirds หรือ Leading Lines เพื่อสร้างภาพที่น่าสนใจ\n\n5. Edit อย่างเป็นธรรมชาติ - การแต่งรูปควรเน้นความเป็นธรรมชาติ ไม่มากเกินไปจนดูปลอม',
            'tags' => 'ถ่ายภาพ,โมเดล,เคล็ดลับ,เทคนิค'
        ],
        [
            'title' => 'การดูแลผิวหน้าในช่วงหน้าร้อน',
            'category_id' => 4, // ความสวยความงาม
            'excerpt' => 'วิธีการดูแลผิวพรรณให้สดใสและมีสุขภาพดีในหน้าร้อนที่ร้อนอบอ้าว',
            'content' => 'หน้าร้อนมาถึงแล้ว และนี่คือเวลาที่ผิวของเราต้องการความดูแลเป็นพิเศษ เนื่องจากอากาศที่ร้อนและแดดจัดอาจทำให้ผิวแห้ง ผิวมัน และเกิดสิวได้ง่าย มาดูกันว่าเราควรดูแลผิวอย่างไรในช่วงนี้\n\nขั้นตอนแรกคือการทำความสะอาดผิวหน้าอย่างละเอียด ใช้โฟมล้างหน้าที่อ่อนโยนและเหมาะกับสภาพผิวของคุณ ควรล้างหน้าอย่างน้อยวันละ 2 ครั้ง เพื่อขจัดสิ่งสกปรกและความมันส่วนเกิน\n\nถัดมาคือการบำรุงผิวด้วยเซรั่มและมอยส์เจอไรเซอร์ เลือกผลิตภัณฑ์ที่มีส่วนผสมของ Hyaluronic Acid หรือ Vitamin C ซึ่งช่วยบำรุงผิวให้ชุ่มชื้นและสดใส\n\nที่สำคัญที่สุดคือการทากันแดด! ใช้ครีมกันแดด SPF 50+ ทุกวัน แม้ว่าจะอยู่ในที่ร่มก็ตาม เพราะรังสี UV ยังสามารถทะลุผ่านกระจกหน้าต่างได้ อย่าลืมทาซ้ำทุก 2-3 ชั่วโมงหากอยู่กลางแจ้งนาน',
            'tags' => 'ผิวหน้า,ความสวย,ดูแลผิว,หน้าร้อน'
        ],
        [
            'title' => 'งานอีเวนต์แฟชั่นโชว์ครั้งใหญ่กำลังจะมาถึง',
            'category_id' => 6, // อีเวนต์
            'excerpt' => 'เตรียมพบกับงานแฟชั่นโชว์ระดับประเทศที่จะจัดขึ้นในเดือนหน้า',
            'content' => 'งานแฟชั่นโชว์ครั้งใหญ่ประจำปี 2025 กำลังจะมาถึงแล้ว! การจัดงานครั้งนี้จะรวบรวมนักออกแบบชั้นนำจากทั่วประเทศมาร่วมแสดงผลงานของตน พร้อมทั้งมีการนำเสนอคอลเลกชันล่าสุดที่จะทำให้คุณตื่นตาตื่นใจ\n\nภายในงานจะมีการจัดแสดงแฟชั่นโชว์ทั้งหมด 3 รอบ ในแต่ละรอบจะมีธีมที่แตกต่างกัน ตั้งแต่ Casual Chic, Evening Elegance ไปจนถึง Street Style ที่กำลังเป็นเทรนด์ในขณะนี้\n\nนอกจากแฟชั่นโชว์แล้ว ยังมีบูธจำหน่ายสินค้าจากแบรนด์ชื่อดังมากมาย Workshop การแต่งหน้า การจัดแต่งทรงผม และการประกวดแฟชั่นสำหรับผู้ที่สนใจ\n\nงานจัดขึ้นที่ Central World ชั้น 5 ระหว่างวันที่ 15-17 มิถุนายนนี้ บัตรราคา 500 บาท จองได้ที่ www.fashionshow2025.com',
            'tags' => 'อีเวนต์,แฟชั่นโชว์,งานแฟชั่น'
        ],
        [
            'title' => 'ไลฟ์สไตล์แบบ Minimalist ที่กำลังมาแรง',
            'category_id' => 3, // ไลฟ์สไตล์
            'excerpt' => 'ค้นหาความสุขในความเรียบง่าย ด้วยการใช้ชีวิตแบบมินิมัลที่กำลังเป็นที่นิยม',
            'content' => 'ไลฟ์สไตล์แบบ Minimalist หรือการใช้ชีวิตแบบเรียบง่าย กำลังได้รับความนิยมอย่างมากในปัจจุบัน เพราะช่วยให้เราโฟกัสกับสิ่งที่สำคัญจริงๆ ในชีวิต และลดความยุ่งเหยิงที่ไม่จำเป็น\n\nการเริ่มต้นใช้ชีวิตแบบมินิมัลไม่ได้หมายความว่าต้องทิ้งของทุกอย่าง แต่เป็นการเลือกเก็บเฉพาะสิ่งที่มีค่าและมีประโยชน์จริงๆ เท่านั้น เริ่มจากการจัดระเบียบบ้าน ทิ้งของที่ไม่ได้ใช้แล้ว และเก็บเฉพาะสิ่งที่คุณรักและใช้งานอยู่จริง\n\nในด้านแฟชั่น มินิมัลลิสต์เน้นการมี Capsule Wardrobe หรือตู้เสื้อผ้าที่มีแต่เสื้อผ้าพื้นฐานที่ใส่ได้ทุกโอกาส Mix & Match ได้หลายแบบ ไม่ต้องมีเสื้อผ้าเยอะแยะ แต่ก็ยังมีสไตล์ที่เป็นเอกลักษณ์\n\nการใช้ชีวิตแบบนี้จะช่วยให้คุณมีเวลามากขึ้นสำหรับสิ่งที่คุณรัก ลดความเครียด และมีความสุขกับสิ่งที่มีอยู่มากขึ้น',
            'tags' => 'ไลฟ์สไตล์,minimalist,การใช้ชีวิต'
        ],
        [
            'title' => 'เบื้องหลังการถ่ายแบบ Fashion Editorial',
            'category_id' => 7, // เบื้องหลัง
            'excerpt' => 'พาไปดูเบื้องหลังการถ่ายแบบแฟชั่นที่หลายคนอาจไม่เคยเห็น',
            'content' => 'การถ่ายแบบแฟชั่น Editorial เป็นงานที่ต้องใช้ทีมงานจำนวนมากและการวางแผนที่ละเอียด วันนี้เราจะพาคุณไปดูเบื้องหลังการถ่ายแบบครั้งหนึ่งที่น่าสนใจ\n\nก่อนวันถ่ายจริง ทีมงานจะต้องมีการประชุมเพื่อกำหนดคอนเซ็ปต์ของแคมเปญ เลือกสถานที่ จัดเตรียมเสื้อผ้า อุปกรณ์ประกอบ และวางแผนการถ่ายทำแต่ละฉาก\n\nในวันถ่ายจริง โมเดลจะมาถึงตั้งแต่เช้าตรู่เพื่อทำผมและแต่งหน้า ซึ่งอาจใช้เวลา 2-3 ชั่วโมง ในระหว่างนี้ช่างภาพจะจัดเตรียมแสงและอุปกรณ์ต่างๆ\n\nการถ่ายภาพแต่ละฉากอาจใช้เวลาตั้งแต่ 30 นาทีถึง 2 ชั่วโมง ขึ้นอยู่กับความซับซ้อนของฉาก โมเดลต้องทำโพสต์ต่างๆ มากมาย และต้องเปลี่ยนชุดหลายครั้ง\n\nหลังจากถ่ายเสร็จ รูปทั้งหมดจะถูกนำไป Retouch และ Color Grading เพื่อให้ได้รูปสุดท้ายที่สวยงามและสมบูรณ์แบบที่คุณเห็นในนิตยสาร',
            'tags' => 'เบื้องหลัง,ถ่ายแบบ,แฟชั่น'
        ],
        [
            'title' => '10 อุปกรณ์เสริมที่ทุกคนควรมี',
            'category_id' => 8, // เคล็ดลับ
            'excerpt' => 'รวมอุปกรณ์เสริมสุดคุ้มที่จะช่วยยกระดับลุคของคุณได้ทันที',
            'content' => 'อุปกรณ์เสริมเป็นสิ่งที่สามารถเปลี่ยนลุคธรรมดาๆ ให้กลายเป็นลุคที่โดดเด่นได้ในพริบตา วันนี้เรามี 10 อุปกรณ์เสริมที่ทุกคนควรมีติดตู้เสื้อผ้าไว้\n\n1. แว่นตากันแดด - ช่วยปกป้องดวงตาและเพิ่มความเท่\n2. ผ้าพันคอ - ใช้ได้หลายแบบทั้งพันคอ ผูกกระเป๋า หรือคาดผม\n3. กระเป๋าสะพาย Cross Body - สะดวกและเก๋\n4. รองเท้า Sneakers ขาว - Mix & Match ได้ง่าย\n5. นาฬิกาข้อมือ - เพิ่มความหรูหราให้ลุค\n6. หมวก Fedora - สไตล์เก๋ๆ ที่ใส่แล้วดูดี\n7. ต่างหูห่วง - Timeless และใส่ได้ทุกวัน\n8. เข็มขัดหนัง - เน้นเอวและดูมีสไตล์\n9. กำไลข้อมือ - เพิ่มดีเทลให้ข้อมือ\n10. กระเป๋าถือ Tote - ใส่ของได้เยอะและดูดี\n\nอุปกรณ์เหล่านี้ล้วนเป็นไอเทมพื้นฐานที่ใช้ได้นาน และสามารถ Mix & Match กับเสื้อผ้าต่างๆ ได้อย่างหลากหลาย',
            'tags' => 'เคล็ดลับ,อุปกรณ์เสริม,แฟชั่น'
        ],
        [
            'title' => 'Makeup Trends 2025 ที่กำลังฮิต',
            'category_id' => 4, // ความสวยความงาม
            'excerpt' => 'อัพเดทเทรนด์แต่งหน้าล่าสุดที่สาวๆ ต้องลอง',
            'content' => 'เทรนด์แต่งหน้าปี 2025 มาพร้อมกับลุคที่หลากหลายและน่าสนใจ ตั้งแต่ลุคธรรมชาติที่เน้นผิวสวยเปล่งประกาย ไปจนถึงลุคสีสันสดใสที่กล้าแสดงออก\n\nGlowy Skin ยังคงเป็นเทรนด์ที่ฮิตต่อเนื่อง เน้นผิวเนียนเรียบเปล่งประกายสุขภาพดี ใช้ไฮไลท์เพื่อเพิ่มมิติให้ใบหน้า และเบลอขอบเขตของไฮไลท์ให้ดูเป็นธรรมชาติ\n\nสำหรับตา ลุคที่กำลังมาแรงคือ Colored Eyeliner โดยเฉพาะสีพาสเทลอย่างสีม่วง สีเขียว และสีฟ้า ที่ช่วยให้ดวงตาดูโดดเด่นและแปลกใหม่\n\nริมฝีปาก Glossy Lips กลับมาเป็นที่นิยมอีกครั้ง เน้นปากชุ่มฉ่ำและดูมีสุขภาพดี ไม่ว่าจะเป็นสีธรรมชาติหรือสีสันสดใส\n\nBlush เป็นอีกหนึ่งไอเทมที่ขาดไม่ได้ เน้นแก้มสีชมพูอมส้มที่ดูสดใสและมีชีวิตชีวา ทาแบบ Soft Cloud Technique เพื่อให้ดูเป็นธรรมชาติ',
            'tags' => 'แต่งหน้า,เทรนด์,ความสวย,makeup'
        ],
        [
            'title' => 'ข่าวดี! เปิดรับสมัครโมเดลรุ่นใหม่',
            'category_id' => 1, // ข่าวสาร
            'excerpt' => 'บริษัทของเรากำลังเปิดรับสมัครโมเดลรุ่นใหม่ที่มีความสามารถพิเศษ',
            'content' => 'VIBEDAYBKK กำลังเปิดรับสมัครโมเดลรุ่นใหม่ที่มีความฝัน อยากเป็นส่วนหนึ่งของวงการแฟชั่นและการถ่ายภาพ เราต้องการคนที่มีความมั่นใจ กล้าแสดงออก และพร้อมที่จะเรียนรู้สิ่งใหม่ๆ\n\nคุณสมบัติผู้สมัคร:\n- เพศชายหรือหญิง อายุ 18-30 ปี\n- ส่วนสูง: ชาย 175 ซม. ขึ้นไป, หญิง 165 ซม. ขึ้นไป\n- มีบุคลิกดี มั่นใจในตัวเอง\n- สามารถทำงานเป็นทีมได้\n- มีความยืดหยุ่นในการทำงาน\n\nเราจะให้การฝึกอบรม:\n- การเดิน Catwalk\n- การถ่ายภาพแฟชั่น\n- การแสดงออกทางสีหน้า\n- การดูแลตัวเองและสุขภาพ\n\nวิธีการสมัคร:\nส่งโปรไฟล์และรูปถ่าย (แบบเต็มตัว 2 ภาพ และแบบครึ่งตัว 2 ภาพ) มาที่ career@vibedaybkk.com ภายในวันที่ 30 มิถุนายนนี้',
            'tags' => 'ข่าวสาร,รับสมัคร,โมเดล'
        ],
        [
            'title' => 'เคล็ดลับการเดินแบบอย่างมืออาชีพ',
            'category_id' => 8, // เคล็ดลับ
            'excerpt' => 'เทคนิคการเดิน Catwalk ที่จะทำให้คุณดูเป็นมืออาชีพบนรันเวย์',
            'content' => 'การเดินแบบ หรือ Catwalk เป็นทักษะพื้นฐานที่สำคัญสำหรับโมเดลทุกคน วันนี้เรามีเคล็ดลับที่จะช่วยให้การเดินของคุณดูมั่นใจและเป็นมืออาชีพมากขึ้น\n\n1. ท่าทางที่ถูกต้อง - ยืดตัวตรง ไหล่เปิด คางยก มองไปข้างหน้า อย่าก้มหน้าหรือหลังโค้ง\n\n2. การเดิน - เดินแบบเส้นตรง เท้าข้างหนึ่งวางตรงไปอีกข้าง (เหมือนเดินบนเส้นจินตนาการ) แต่ไม่ควรเกินไปจนเซซวง\n\n3. การแกว่งแขน - ให้แขนแกว่งไปตามธรรมชาติ ไม่มากหรือน้อยเกินไป\n\n4. สายตา - มองไปข้างหน้า ไม่มองพื้นหรือมองคนดู มองไปที่จุดหนึ่งเพื่อให้มั่นใจ\n\n5. ความเร็ว - เดินด้วยความเร็วที่พอดี ไม่เร็วหรือช้าเกินไป ควรฝึกจับจังหวะเพลงที่ใช้ในโชว์\n\n6. การหมุนตัว - เมื่อถึงจุดสิ้นสุดของรันเวย์ ให้หมุนตัวอย่างมั่นใจ หันหลังกลับไปอย่างสวยงาม\n\n7. สีหน้าท่าทาง - ใบหน้าควรดูมั่นใจ อาจยิ้มเบาๆ หรือทำหน้าเฉยๆ ขึ้นอยู่กับคอนเซ็ปต์ของโชว์\n\nการฝึกฝนอย่างสม่ำเสมอจะทำให้การเดินของคุณดูเป็นธรรมชาติและมืออาชีพมากขึ้น',
            'tags' => 'เคล็ดลับ,การเดินแบบ,catwalk,โมเดล'
        ],
        [
            'title' => 'Street Style Fashion จากงาน Bangkok Fashion Week',
            'category_id' => 2, // แฟชั่น
            'excerpt' => 'ชมสไตล์เก๋ๆ จากผู้เข้าร่วมงาน Bangkok Fashion Week ที่จะเป็นแรงบันดาลใจให้คุณ',
            'content' => 'งาน Bangkok Fashion Week เป็นงานที่รวบรวมคนรักแฟชั่นจากทั่วประเทศ และแน่นอนว่าสไตล์การแต่งตัวของผู้เข้าร่วมงานก็ไม่ธรรมดา วันนี้เรามีภาพ Street Style ที่น่าสนใจมาฝากกัน\n\nเทรนด์ที่เห็นได้ชัดในปีนี้คือการผสมผสานระหว่าง High Fashion กับ Streetwear อย่างลงตัว มีการใช้ Oversized Blazer คู่กับ Baggy Jeans และ Chunky Sneakers ซึ่งดูเก๋และสบายในเวลาเดียวกัน\n\nสีที่มีคนใส่กันเยอะคือ Neutral Tone ทั้งสีเบจ สีครีม และสีน้ำตาล ที่ให้ลุคที่ดูมีระดับและหรูหรา บางคนเลือกใส่ All Black เพื่อดูดูเท่ห์และเฉียบขาด\n\nอุปกรณ์เสริมที่ฮอตในงานนี้ต้องยกให้ กระเป๋า Mini Bag, แว่นตากันแดดรูปทรง Geometric และหมวก Bucket Hat ที่ช่วยเติมเต็มลุคให้สมบูรณ์\n\nการมางานแฟชั่นไม่ใช่แค่มาดูแฟชั่นโชว์ แต่ยังเป็นโอกาสในการแสดงสไตล์ของตัวเองและหาแรงบันดาลใจจากคนอื่นๆ ด้วย',
            'tags' => 'แฟชั่น,street style,bangkok fashion week'
        ],
        [
            'title' => 'การเลือกโทนสีให้เข้ากับผิว',
            'category_id' => 4, // ความสวยความงาม
            'excerpt' => 'รู้จักกับ Undertone ของผิวเพื่อเลือกสีเสื้อผ้าและเครื่องสำอางที่เหมาะกับคุณ',
            'content' => 'การรู้ว่าผิวของเรามี Undertone แบบไหน จะช่วยให้เราเลือกสีเสื้อผ้าและเครื่องสำอางได้ถูกต้อง ทำให้ดูเข้ากับผิวและสวยขึ้น\n\nUndertone แบ่งเป็น 3 ประเภท:\n\n1. Cool Undertone (โทนเย็น) - ผิวจะมีโทนสีชมพู สีแดง หรือสีน้ำเงิน เหมาะกับสีเย็นอย่างสีน้ำเงิน สีม่วง สีเขียว และสีเทา\n\n2. Warm Undertone (โทนอุ่น) - ผิวจะมีโทนสีเหลือง สีพีช หรือสีทอง เหมาะกับสีอุ่นอย่างสีแดง สีส้ม สีเหลือง และสีน้ำตาล\n\n3. Neutral Undertone (โทนกลาง) - ผิวเป็นการผสมผสานระหว่างโทนเย็นและอุ่น เหมาะกับสีทุกโทน แต่ควรเลือกสีที่ไม่จัดจ้านเกินไป\n\nวิธีทดสอบ Undertone:\n- ดูเส้นเลือดที่ข้อมือ ถ้าเป็นสีน้ำเงินคือโทนเย็น ถ้าเป็นสีเขียวคือโทนอุ่น\n- ลองสวมเสื้อสีเงินและสีทอง ถ้าสีเงินเข้ากับผิวคือโทนเย็น ถ้าสีทองเข้ากับผิวคือโทนอุ่น\n- ดูว่าเมื่ออยู่แดด ผิวเป็นแดงหรือเป็นสีแทน ถ้าเป็นแดงคือโทนเย็น ถ้าเป็นสีแทนคือโทนอุ่น',
            'tags' => 'ความสวย,undertone,การเลือกสี'
        ],
        [
            'title' => 'ประสบการณ์การทำงานโมเดล: เรื่องจริงจากคนในวงการ',
            'category_id' => 7, // เบื้องหลัง
            'excerpt' => 'ฟังเรื่องราวจริงจากโมเดลมืออาชีพว่าอาชีพนี้เป็นอย่างไร',
            'content' => 'การเป็นโมเดลอาจดูเป็นอาชีพที่น่าสนใจและโกลมเกลา แต่ด้านหลังของความเก๋ไก๋นั้นมีความพยายามและความท้าทายมากมาย วันนี้เราได้สัมภาษณ์โมเดลมืออาชีพมาเล่าประสบการณ์\n\n"การตื่นเช้าเพื่อไปเซ็ตถ่ายแต่เช้าตรู่ เมคอัพเสร็จตอน 6 โมงเช้า ถ่ายภาพจนบ่าย ต้องยืนโพสต์เป็นชั่วโมง ต่อมาหลังทำงานก็เจ็บ แต่ก็คุ้มค่าเมื่อได้เห็นผลงานที่ออกมาสวยงาม"\n\n"สิ่งที่ยากที่สุดคือการรักษาหุ่น ต้องออกกำลังกายสม่ำเสมอ กินอาหารให้ครบ 5 หมู่ แต่ไม่มากเกินไป และต้องดูแลผิวพรรณให้สวยอยู่เสมอ"\n\n"แต่สิ่งที่ดีที่สุดคือได้พบเจอผู้คนใหม่ๆ ได้ทำงานในสถานที่ต่างๆ ได้สวมใส่เสื้อผ้าสวยๆ จากแบรนด์ดัง และที่สำคัญคือได้ทำในสิ่งที่รัก"\n\n"คำแนะนำสำหรับคนที่อยากเป็นโมเดล: ต้องมีความมั่นใจ กล้าที่จะเป็นตัวของตัวเอง อย่ายอมแพ้กับการถูกปฏิเสธ และที่สำคัญคือต้องรักและเคารพตัวเอง"',
            'tags' => 'เบื้องหลัง,โมเดล,ประสบการณ์'
        ],
        [
            'title' => 'Sustainable Fashion: แฟชั่นที่ใส่ใจสิ่งแวดล้อม',
            'category_id' => 2, // แฟชั่น
            'excerpt' => 'ทำความรู้จักกับแฟชั่นที่เป็นมิตรกับโลกและทำไมเราควรให้ความสนใจ',
            'content' => 'Sustainable Fashion หรือแฟชั่นยั่งยืน กำลังเป็นกระแสใหญ่ในวงการแฟชั่นโลก เพราะอุตสาหกรรมแฟชั่นเป็นหนึ่งในอุตสาหกรรมที่ส่งผลกระทบต่อสิ่งแวดล้อมมากที่สุด\n\nแฟชั่นยั่งยืนคืออะไร?\nคือการผลิตเสื้อผ้าและสินค้าแฟชั่นที่คำนึงถึงผลกระทบต่อสิ่งแวดล้อมและสังคม โดยใช้วัสดุที่เป็นมิตรกับสิ่งแวดล้อม ใช้กระบวนการผลิตที่ลดการปล่อยมลพิษ และดูแลสวัสดิการของคนงาน\n\nทำอย่างไรจึงจะเป็นส่วนหนึ่งของ Sustainable Fashion?\n1. ซื้อเสื้อผ้าคุณภาพดีที่ใช้งานได้นาน แทนการซื้อเยอะแต่ไม่มีคุณภาพ\n2. เลือกแบรนด์ที่ใส่ใจสิ่งแวดล้อม\n3. ซื้อเสื้อผ้ามือสอง (Thrift Shopping)\n4. รีไซเคิลเสื้อผ้าเก่า ดัดแปลงให้เป็นของใหม่\n5. ดูแลเสื้อผ้าให้ใช้งานได้นาน\n6. แลกเปลี่ยนเสื้อผ้ากับเพื่อน (Clothing Swap)\n\nการเลือกใช้แฟชั่นอย่างมีสติจะช่วยลดผลกระทบต่อโลก และยังช่วยประหยัดเงินในกระเป๋าด้วย',
            'tags' => 'แฟชั่น,sustainable,สิ่งแวดล้อม'
        ],
        [
            'title' => 'How to Build Your Portfolio as a Model',
            'category_id' => 8, // เคล็ดลับ
            'excerpt' => 'คู่มือการสร้าง Portfolio ที่จะทำให้คุณโดดเด่นในวงการโมเดล',
            'content' => 'Portfolio หรือ Book เป็นสิ่งสำคัญสำหรับโมเดล เพราะเป็นเครื่องมือที่ใช้แสดงผลงานและความสามารถของคุณให้ Client หรือ Agency เห็น วันนี้เรามีเคล็ดลับการสร้าง Portfolio ที่ดีมาแนะนำ\n\nประเภทของภาพที่ควรมี:\n1. Headshot - ภาพใบหน้าแบบ Close-up ทั้งแบบแต่งหน้าและไม่แต่งหน้า\n2. Full Body Shot - ภาพเต็มตัวที่แสดงรูปร่างหุ่นของคุณ\n3. Fashion Editorial - ภาพแฟชั่นที่ดูเป็นมืออาชีพ\n4. Commercial - ภาพที่ดูเป็นกันเองและใช้ในโฆษณาได้\n5. Beauty Shot - ภาพที่เน้นความสวยของใบหน้า\n\nเคล็ดลับการสร้าง Portfolio:\n- เริ่มต้นด้วยการถ่าย Test Shoot กับช่างภาพ (TFP - Time for Prints)\n- เลือกภาพที่หลากหลาย แสดงความสามารถที่แตกต่างกัน\n- อัพเดท Portfolio เป็นประจำด้วยผลงานใหม่ๆ\n- จัดเรียงภาพจากดีที่สุดไปหาด้อยที่สุด\n- ไม่ใส่ภาพมากเกินไป 15-20 ภาพก็เพียงพอ\n- มีทั้งรูปแบบ Digital และ Print\n\nในปัจจุบัน Portfolio Online บนโซเชียลมีเดียก็สำคัญเช่นกัน ควรมี Instagram หรือเว็บไซต์ส่วนตัวที่แสดงผลงานอย่างเป็นระบบ',
            'tags' => 'เคล็ดลับ,portfolio,โมเดล'
        ]
    ];
    
    // เลือกบทความตามindex
    $article = $articles_data[$index % count($articles_data)];
    
    $title = $article['title'];
    $category_id = $article['category_id'];
    $excerpt = $article['excerpt'];
    $content = $article['content'];
    $tags = $article['tags'];
    $slug = createSlug($title);
    $status = 'published';
    $author_id = 1; // สมมติว่า admin มี id = 1
    $published_at = date('Y-m-d H:i:s', strtotime('-' . rand(1, 30) . ' days')); // สุ่มวันที่ในช่วง 1-30 วันที่ผ่านมา
    
    // ตรวจสอบว่า slug ซ้ำหรือไม่
    $check_stmt = $conn->prepare("SELECT id FROM articles WHERE slug = ?");
    $check_stmt->bind_param("s", $slug);
    $check_stmt->execute();
    $check_result = $check_stmt->get_result();
    
    if ($check_result->num_rows > 0) {
        $slug = $slug . '-' . time();
    }
    
    try {
        // สร้าง SQL query ตามคอลัมน์ที่มีจริง
        $fields = ['title', 'slug', 'status'];
        $values = [$title, $slug, $status];
        $types = 'sss';
        
        if (in_array('excerpt', $existing_columns)) {
            $fields[] = 'excerpt';
            $values[] = $excerpt;
            $types .= 's';
        }
        
        if (in_array('content', $existing_columns)) {
            $fields[] = 'content';
            $values[] = $content;
            $types .= 's';
        }
        
        if (in_array('category_id', $existing_columns)) {
            $fields[] = 'category_id';
            $values[] = $category_id;
            $types .= 'i';
        }
        
        if (in_array('author_id', $existing_columns)) {
            $fields[] = 'author_id';
            $values[] = $author_id;
            $types .= 'i';
        }
        
        if (in_array('tags', $existing_columns)) {
            $fields[] = 'tags';
            $values[] = $tags;
            $types .= 's';
        }
        
        if (in_array('published_at', $existing_columns)) {
            $fields[] = 'published_at';
            $values[] = $published_at;
            $types .= 's';
        }
        
        $fields_str = implode(', ', $fields);
        $placeholders = implode(', ', array_fill(0, count($fields), '?'));
        
        $sql = "INSERT INTO articles ($fields_str) VALUES ($placeholders)";
        $stmt = $conn->prepare($sql);
        $stmt->bind_param($types, ...$values);
        
        if ($stmt->execute()) {
            echo json_encode([
                'success' => true,
                'id' => $conn->insert_id,
                'title' => $title,
                'slug' => $slug
            ]);
        } else {
            echo json_encode([
                'success' => false,
                'error' => $stmt->error
            ]);
        }
        
        $stmt->close();
    } catch (Exception $e) {
        echo json_encode([
            'success' => false,
            'error' => $e->getMessage()
        ]);
    }
    
    exit;
}

echo json_encode(['success' => false, 'error' => 'Invalid action']);
$conn->close();
?>

